<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobil EKG Ã–ÄŸrenme Sistemi Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #e2e8f0; border-radius: 8px; }
        button { background: #3b82f6; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; margin: 5px; }
        button:hover { background: #2563eb; }
        .success { background: #dcfce7; border-color: #10b981; }
        .info { background: #dbeafe; border-color: #3b82f6; }
        .result { margin: 10px 0; padding: 10px; background: #f8fafc; border-radius: 6px; font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  Mobil EKG Ã–ÄŸrenme Sistemi Test</h1>
        <p>Bu sayfa mobil Ã¶ÄŸrenme sisteminin Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± test eder.</p>
        
        <div class="test-section">
            <h3>ğŸ“Š Sistem Durumu</h3>
            <button onclick="testSystemStatus()">Sistem Durumunu Kontrol Et</button>
            <div id="systemStatus" class="result"></div>
        </div>
        
        <div class="test-section">
            <h3>ğŸ¯ Ã–ÄŸrenme Testi</h3>
            <button onclick="testLearning()">Ã–rnek Ã–ÄŸrenme Verisi Ekle</button>
            <button onclick="testPrediction()">Adaptif Tahmin Testi</button>
            <div id="learningTest" class="result"></div>
        </div>
        
        <div class="test-section success">
            <h3>ğŸ“ˆ Ä°statistikler</h3>
            <button onclick="showStats()">Ã–ÄŸrenme Ä°statistiklerini GÃ¶ster</button>
            <div id="statsDisplay" class="result"></div>
        </div>
        
        <div class="test-section info">
            <h3>ğŸ”„ Sistem YÃ¶netimi</h3>
            <button onclick="resetSystem()">Sistemi SÄ±fÄ±rla</button>
            <button onclick="exportData()">Verileri DÄ±ÅŸa Aktar</button>
            <div id="managementResult" class="result"></div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // Test fonksiyonlarÄ±
        function testSystemStatus() {
            const stats = mobileEKGLearning.getLearningStats();
            document.getElementById('systemStatus').innerHTML = `
                <strong>Sistem Durumu:</strong><br>
                âœ… Mobil Ã¶ÄŸrenme sistemi aktif<br>
                ğŸ“Š Toplam dÃ¼zeltme: ${stats.total_corrections}<br>
                ğŸ¯ Benzersiz patern: ${stats.unique_patterns}<br>
                ğŸ“… Son 7 gÃ¼n: ${stats.recent_corrections}<br>
                ğŸ“ˆ Tahmini doÄŸruluk artÄ±ÅŸÄ±: +${stats.accuracy_improvement}%<br>
                ğŸ”„ Ã–ÄŸrenme aktif: ${stats.learning_active ? 'Evet' : 'HayÄ±r (5+ dÃ¼zeltme gerekli)'}
            `;
        }
        
        function testLearning() {
            // Ã–rnek Ã¶ÄŸrenme verisi ekle
            const sampleFeatures = {
                heart_rate: 85,
                rr_variability: 15,
                qrs_width: 95,
                signal_quality: "Ä°yi"
            };
            
            const result = mobileEKGLearning.learnFromUserCorrection(
                "Normal SinÃ¼s Ritmi", 
                "SinÃ¼s TaÅŸikardisi", 
                sampleFeatures
            );
            
            document.getElementById('learningTest').innerHTML = `
                <strong>Ã–ÄŸrenme Testi Sonucu:</strong><br>
                ${result}<br><br>
                <strong>Eklenen Veri:</strong><br>
                Orijinal: Normal SinÃ¼s Ritmi<br>
                DÃ¼zeltme: SinÃ¼s TaÅŸikardisi<br>
                Kalp HÄ±zÄ±: ${sampleFeatures.heart_rate} bpm<br>
                Variabilite: ${sampleFeatures.rr_variability}%
            `;
        }
        
        function testPrediction() {
            // Adaptif tahmin testi
            const mockResult = {
                rhythm: "Normal SinÃ¼s Ritmi",
                confidence: 70,
                description: "Test tahmini"
            };
            
            const mockFeatures = {
                heart_rate: 85,
                rr_variability: 15,
                qrs_width: 95,
                signal_quality: "Ä°yi"
            };
            
            const adaptedResult = mobileEKGLearning.adaptivePrediction(mockResult, mockFeatures);
            
            document.getElementById('learningTest').innerHTML += `
                <br><br><strong>Adaptif Tahmin Testi:</strong><br>
                Ã–ÄŸrenme uygulandÄ±: ${adaptedResult.learning_applied ? 'Evet' : 'HayÄ±r'}<br>
                Benzer vaka sayÄ±sÄ±: ${adaptedResult.similar_cases_found || 0}<br>
                GÃ¼ven deÄŸiÅŸimi: ${adaptedResult.confidence_adjustment || 0}<br>
                Yeni gÃ¼ven skoru: ${adaptedResult.confidence}%
            `;
        }
        
        function showStats() {
            const stats = mobileEKGLearning.getLearningStats();
            document.getElementById('statsDisplay').innerHTML = `
                <strong>DetaylÄ± Ä°statistikler:</strong><br>
                ğŸ“Š Toplam DÃ¼zeltme: ${stats.total_corrections}<br>
                ğŸ¯ Benzersiz Paternler: ${stats.unique_patterns}<br>
                ğŸ“… Son 7 GÃ¼n: ${stats.recent_corrections}<br>
                ğŸ“ˆ DoÄŸruluk ArtÄ±ÅŸÄ±: +${stats.accuracy_improvement}%<br>
                ğŸ”„ Ã–ÄŸrenme Durumu: ${stats.learning_active ? 'Aktif' : 'Pasif'}<br><br>
                <strong>KayÄ±tlÄ± DÃ¼zeltmeler:</strong><br>
                ${mobileEKGLearning.userCorrections.length > 0 ? 
                    mobileEKGLearning.userCorrections.slice(-3).map(c => 
                        `â€¢ ${c.original} â†’ ${c.corrected} (${new Date(c.timestamp).toLocaleString()})`
                    ).join('<br>') : 
                    'HenÃ¼z dÃ¼zeltme kaydÄ± yok'
                }
            `;
        }
        
        function resetSystem() {
            if (confirm('TÃ¼m Ã¶ÄŸrenme verileri silinecek. Emin misiniz?')) {
                const result = mobileEKGLearning.resetLearning();
                document.getElementById('managementResult').innerHTML = `
                    <strong>SÄ±fÄ±rlama Sonucu:</strong><br>
                    ${result}
                `;
            }
        }
        
        function exportData() {
            const stats = mobileEKGLearning.getLearningStats();
            const corrections = mobileEKGLearning.userCorrections;
            
            const exportData = {
                export_date: new Date().toISOString(),
                statistics: stats,
                corrections: corrections,
                version: "1.0"
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `ekg-learning-test-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            document.getElementById('managementResult').innerHTML = `
                <strong>DÄ±ÅŸa Aktarma:</strong><br>
                âœ… Veriler baÅŸarÄ±yla dÄ±ÅŸa aktarÄ±ldÄ±<br>
                ğŸ“ Dosya: ekg-learning-test-${new Date().toISOString().split('T')[0]}.json
            `;
        }
        
        // Sayfa yÃ¼klendiÄŸinde sistem durumunu gÃ¶ster
        window.onload = function() {
            testSystemStatus();
        };
    </script>
</body>
</html>